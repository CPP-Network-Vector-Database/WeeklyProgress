-- Sample Vector Operations on Different Indexes

-- Query 1: Nearest Neighbor Search with IVFFlat
SELECT frame_number, frame_time, ip_src, ip_dst, tcp_srcport, tcp_dstport, protocol, frame_len, embedding
FROM network_traffic_ivf
ORDER BY embedding <=> '[0.001047,0.05761,-0.049761,0.006044,-0.082155,-0.068032,0.031118,0.001534,-0.003469,-0.022295,-0.037904,-0.062905,0.020716,-5e-05,0.035432,-0.028556,-0.039935,-0.087186,-0.004333,-0.028506,-0.023882,0.039156,-0.040344,-0.030104,0.002576,0.026598,-0.025732,0.055856,0.019161,-0.036489,-0.089994,0.025581,-0.037664,0.009907,-0.08406,-0.07957,-0.04822,-0.04798,-0.00666,0.026506,0.035922,0.00135,0.111183,0.054961,0.019476,0.02874,-0.041432,0.149745,0.060976,-0.068772,-0.016007,0.024525,-0.027068,0.052283,0.026125,0.011397,-0.034266,-0.036035,-0.025243,-0.011355,0.036635,0.017482,-0.030254,0.080118,0.078688,-0.070037,-0.047792,0.043284,0.065689,-0.02105,-0.044606,0.012727,-0.082126,-0.009596,0.023298,0.037441,-0.023563,0.016792,0.052119,0.00629,0.015001,-0.029059,-0.011732,-0.021819,0.009072,-0.070698,0.086423,0.011135,0.031143,-0.010418,0.00076,0.059775,-0.103665,0.023707,-0.060099,0.084904,0.045173,-0.117224,-0.019724,0.041206,0.077275,0.02075,-0.03925,0.057587,-0.083859,-0.028299,0.054778,0.096486,0.071814,0.095449,-0.057417,0.018605,0.013273,-0.013304,-0.012277,0.010914,-0.051666,0.008889,-0.043728,0.008945,0.005312,0.004783,-0.062221,0.005835,-0.083235,0.005685,0.050154,0,0.047425,0.002321,0.020582,-0.021209,0.007559,0.00661,-0.019001,-0.028853,-0.061182,-0.031955,-0.063446,0.011539,-0.029089,0.033035,-0.00669,0.01457,0.034262,0.062367,0.04284,0.050965,-0.046205,0.009311,-0.0275,0.02206,0.026157,0.07922,-0.081095,-0.028799,-0.101099,0.010728,0.131829,-0.046651,-0.067109,0.000356,0.018528,-0.03219,0.055784,-0.014037,0.071682,0.046096,-0.041276,0.037476,0.014455,0.00165,-0.05075,-0.023498,0.001347,-0.012045,0.047421,0.06973,-0.090741,0.003478,-0.063364,0.015379,-0.008301,-0.006809,-0.007509,0.04953,-0.038572,0.093173,0.020081,0.042386,-0.046278,-0.071677,0.01374,0.033862,-0.053179,-0.024812,0.034274,0.058316,0.006578,0.023881,0.149914,0.045956,0.056278,0.016982,0.009524,-0.011581,-0.007151,0.038278,-0.117852,0.036805,-0.009551,-0.025841,-0.107119,-0.053273,0.012198,0.042947,0.120374,0.085906,-0.075599,0.013293,0.01664,0.00974,-0.076473,0,-0.009282,0.126683,-0.034814,0.018548,-0.019534,-0.017335,0.129658,0.031364,0.018901,0.036265,0.083719,-0.029418,0.054458,0.011618,0.018144,-0.019034,0.011953,-0.029437,-0.104044,-0.022645,-0.108522,0.012095,-0.008892,0.007199,0.012115,-0.003089,-0.002098,-0.086063,-0.099399,-0.044523,-0.010077,-0.042991,-0.040193,0.067323,-0.003182,-0.032191,0.086047,0.108777,0.026362,-0.011979,0.071559,0.040289,-0.028287,0.04831,0.059803,-0.017369,0.106129,-0.052919,-0.065957,-0.041301,0.051324,-0.050371,0.027128,0.082471,0.019871,0.043742,0.019467,0.068107,0.002847,0.009033,0.090858,-0.057667,-0.051794,0.073382,0.08674,-0.01965,-0.073387,-0.011621,0.062587,0.015102,-0.046239,0.006864,0.111094,0.011186,0.070184,-0.029243,0.017467,0.016068,-0.035176,-0.016001,-0.048663,0.07754,0.010788,-0.087545,0.015634,0.044651,0.035204,0.030295,-0.024961,-0.019756,-0.091956,0.083481,-0.07207,-0.030486,0.031459,0,-0.01435,0.018892,-0.054858,0.083456,-0.016066,0.142768,0.049076,0.015662,-0.000303,0.002781,0.023061,-0.040918,-0.00929,-0.044196,0.007489,-0.061206,-0.07306,0.039832,-0.023916,-0.094452,-0.003662,0.025215,-0.043658,0.036914,-0.021507,0.001247,0.036317,0.034739,-0.065639,0.011099,-0.056292,-0.051628,-0.007438,-0.054219,0.021565,0.086079,-0.089869,0.074005,0.037545,0.070924,-0.028373,-0.033131,0.006777,-0.03776,0.090828,-0.043021,-0.023421,0.033723,0.037839,-0.103213,0.017492,-0.031629,0.059406,-0.026698,0.022034,0.004997,-0.066013,-0.025418,-0.102323,-0.007298,-0.047351,0.031364,-0.084918,-0.065701]'
LIMIT 1000;

-- Query 2: Nearest Neighbor Search with HNSW
SELECT frame_number, frame_time, ip_src, ip_dst, tcp_srcport, tcp_dstport, protocol, frame_len, embedding
FROM network_traffic_hnsw
ORDER BY embedding <=> '[0.001047,0.05761,-0.049761,0.006044,-0.082155,-0.068032,0.031118,0.001534,-0.003469,-0.022295,-0.037904,-0.062905,0.020716,-5e-05,0.035432,-0.028556,-0.039935,-0.087186,-0.004333,-0.028506,-0.023882,0.039156,-0.040344,-0.030104,0.002576,0.026598,-0.025732,0.055856,0.019161,-0.036489,-0.089994,0.025581,-0.037664,0.009907,-0.08406,-0.07957,-0.04822,-0.04798,-0.00666,0.026506,0.035922,0.00135,0.111183,0.054961,0.019476,0.02874,-0.041432,0.149745,0.060976,-0.068772,-0.016007,0.024525,-0.027068,0.052283,0.026125,0.011397,-0.034266,-0.036035,-0.025243,-0.011355,0.036635,0.017482,-0.030254,0.080118,0.078688,-0.070037,-0.047792,0.043284,0.065689,-0.02105,-0.044606,0.012727,-0.082126,-0.009596,0.023298,0.037441,-0.023563,0.016792,0.052119,0.00629,0.015001,-0.029059,-0.011732,-0.021819,0.009072,-0.070698,0.086423,0.011135,0.031143,-0.010418,0.00076,0.059775,-0.103665,0.023707,-0.060099,0.084904,0.045173,-0.117224,-0.019724,0.041206,0.077275,0.02075,-0.03925,0.057587,-0.083859,-0.028299,0.054778,0.096486,0.071814,0.095449,-0.057417,0.018605,0.013273,-0.013304,-0.012277,0.010914,-0.051666,0.008889,-0.043728,0.008945,0.005312,0.004783,-0.062221,0.005835,-0.083235,0.005685,0.050154,0,0.047425,0.002321,0.020582,-0.021209,0.007559,0.00661,-0.019001,-0.028853,-0.061182,-0.031955,-0.063446,0.011539,-0.029089,0.033035,-0.00669,0.01457,0.034262,0.062367,0.04284,0.050965,-0.046205,0.009311,-0.0275,0.02206,0.026157,0.07922,-0.081095,-0.028799,-0.101099,0.010728,0.131829,-0.046651,-0.067109,0.000356,0.018528,-0.03219,0.055784,-0.014037,0.071682,0.046096,-0.041276,0.037476,0.014455,0.00165,-0.05075,-0.023498,0.001347,-0.012045,0.047421,0.06973,-0.090741,0.003478,-0.063364,0.015379,-0.008301,-0.006809,-0.007509,0.04953,-0.038572,0.093173,0.020081,0.042386,-0.046278,-0.071677,0.01374,0.033862,-0.053179,-0.024812,0.034274,0.058316,0.006578,0.023881,0.149914,0.045956,0.056278,0.016982,0.009524,-0.011581,-0.007151,0.038278,-0.117852,0.036805,-0.009551,-0.025841,-0.107119,-0.053273,0.012198,0.042947,0.120374,0.085906,-0.075599,0.013293,0.01664,0.00974,-0.076473,0,-0.009282,0.126683,-0.034814,0.018548,-0.019534,-0.017335,0.129658,0.031364,0.018901,0.036265,0.083719,-0.029418,0.054458,0.011618,0.018144,-0.019034,0.011953,-0.029437,-0.104044,-0.022645,-0.108522,0.012095,-0.008892,0.007199,0.012115,-0.003089,-0.002098,-0.086063,-0.099399,-0.044523,-0.010077,-0.042991,-0.040193,0.067323,-0.003182,-0.032191,0.086047,0.108777,0.026362,-0.011979,0.071559,0.040289,-0.028287,0.04831,0.059803,-0.017369,0.106129,-0.052919,-0.065957,-0.041301,0.051324,-0.050371,0.027128,0.082471,0.019871,0.043742,0.019467,0.068107,0.002847,0.009033,0.090858,-0.057667,-0.051794,0.073382,0.08674,-0.01965,-0.073387,-0.011621,0.062587,0.015102,-0.046239,0.006864,0.111094,0.011186,0.070184,-0.029243,0.017467,0.016068,-0.035176,-0.016001,-0.048663,0.07754,0.010788,-0.087545,0.015634,0.044651,0.035204,0.030295,-0.024961,-0.019756,-0.091956,0.083481,-0.07207,-0.030486,0.031459,0,-0.01435,0.018892,-0.054858,0.083456,-0.016066,0.142768,0.049076,0.015662,-0.000303,0.002781,0.023061,-0.040918,-0.00929,-0.044196,0.007489,-0.061206,-0.07306,0.039832,-0.023916,-0.094452,-0.003662,0.025215,-0.043658,0.036914,-0.021507,0.001247,0.036317,0.034739,-0.065639,0.011099,-0.056292,-0.051628,-0.007438,-0.054219,0.021565,0.086079,-0.089869,0.074005,0.037545,0.070924,-0.028373,-0.033131,0.006777,-0.03776,0.090828,-0.043021,-0.023421,0.033723,0.037839,-0.103213,0.017492,-0.031629,0.059406,-0.026698,0.022034,0.004997,-0.066013,-0.025418,-0.102323,-0.007298,-0.047351,0.031364,-0.084918,-0.065701]'
LIMIT 1000;

EXPLAIN ANALYZE
SELECT frame_number, frame_time, ip_src, ip_dst, tcp_srcport, tcp_dstport, protocol, frame_len, embedding
FROM network_traffic_ivf
ORDER BY embedding <=> '[0.001047,0.05761,-0.049761,0.006044,-0.082155,-0.068032,0.031118,0.001534,-0.003469,-0.022295,-0.037904,-0.062905,0.020716,-5e-05,0.035432,-0.028556,-0.039935,-0.087186,-0.004333,-0.028506,-0.023882,0.039156,-0.040344,-0.030104,0.002576,0.026598,-0.025732,0.055856,0.019161,-0.036489,-0.089994,0.025581,-0.037664,0.009907,-0.08406,-0.07957,-0.04822,-0.04798,-0.00666,0.026506,0.035922,0.00135,0.111183,0.054961,0.019476,0.02874,-0.041432,0.149745,0.060976,-0.068772,-0.016007,0.024525,-0.027068,0.052283,0.026125,0.011397,-0.034266,-0.036035,-0.025243,-0.011355,0.036635,0.017482,-0.030254,0.080118,0.078688,-0.070037,-0.047792,0.043284,0.065689,-0.02105,-0.044606,0.012727,-0.082126,-0.009596,0.023298,0.037441,-0.023563,0.016792,0.052119,0.00629,0.015001,-0.029059,-0.011732,-0.021819,0.009072,-0.070698,0.086423,0.011135,0.031143,-0.010418,0.00076,0.059775,-0.103665,0.023707,-0.060099,0.084904,0.045173,-0.117224,-0.019724,0.041206,0.077275,0.02075,-0.03925,0.057587,-0.083859,-0.028299,0.054778,0.096486,0.071814,0.095449,-0.057417,0.018605,0.013273,-0.013304,-0.012277,0.010914,-0.051666,0.008889,-0.043728,0.008945,0.005312,0.004783,-0.062221,0.005835,-0.083235,0.005685,0.050154,0,0.047425,0.002321,0.020582,-0.021209,0.007559,0.00661,-0.019001,-0.028853,-0.061182,-0.031955,-0.063446,0.011539,-0.029089,0.033035,-0.00669,0.01457,0.034262,0.062367,0.04284,0.050965,-0.046205,0.009311,-0.0275,0.02206,0.026157,0.07922,-0.081095,-0.028799,-0.101099,0.010728,0.131829,-0.046651,-0.067109,0.000356,0.018528,-0.03219,0.055784,-0.014037,0.071682,0.046096,-0.041276,0.037476,0.014455,0.00165,-0.05075,-0.023498,0.001347,-0.012045,0.047421,0.06973,-0.090741,0.003478,-0.063364,0.015379,-0.008301,-0.006809,-0.007509,0.04953,-0.038572,0.093173,0.020081,0.042386,-0.046278,-0.071677,0.01374,0.033862,-0.053179,-0.024812,0.034274,0.058316,0.006578,0.023881,0.149914,0.045956,0.056278,0.016982,0.009524,-0.011581,-0.007151,0.038278,-0.117852,0.036805,-0.009551,-0.025841,-0.107119,-0.053273,0.012198,0.042947,0.120374,0.085906,-0.075599,0.013293,0.01664,0.00974,-0.076473,0,-0.009282,0.126683,-0.034814,0.018548,-0.019534,-0.017335,0.129658,0.031364,0.018901,0.036265,0.083719,-0.029418,0.054458,0.011618,0.018144,-0.019034,0.011953,-0.029437,-0.104044,-0.022645,-0.108522,0.012095,-0.008892,0.007199,0.012115,-0.003089,-0.002098,-0.086063,-0.099399,-0.044523,-0.010077,-0.042991,-0.040193,0.067323,-0.003182,-0.032191,0.086047,0.108777,0.026362,-0.011979,0.071559,0.040289,-0.028287,0.04831,0.059803,-0.017369,0.106129,-0.052919,-0.065957,-0.041301,0.051324,-0.050371,0.027128,0.082471,0.019871,0.043742,0.019467,0.068107,0.002847,0.009033,0.090858,-0.057667,-0.051794,0.073382,0.08674,-0.01965,-0.073387,-0.011621,0.062587,0.015102,-0.046239,0.006864,0.111094,0.011186,0.070184,-0.029243,0.017467,0.016068,-0.035176,-0.016001,-0.048663,0.07754,0.010788,-0.087545,0.015634,0.044651,0.035204,0.030295,-0.024961,-0.019756,-0.091956,0.083481,-0.07207,-0.030486,0.031459,0,-0.01435,0.018892,-0.054858,0.083456,-0.016066,0.142768,0.049076,0.015662,-0.000303,0.002781,0.023061,-0.040918,-0.00929,-0.044196,0.007489,-0.061206,-0.07306,0.039832,-0.023916,-0.094452,-0.003662,0.025215,-0.043658,0.036914,-0.021507,0.001247,0.036317,0.034739,-0.065639,0.011099,-0.056292,-0.051628,-0.007438,-0.054219,0.021565,0.086079,-0.089869,0.074005,0.037545,0.070924,-0.028373,-0.033131,0.006777,-0.03776,0.090828,-0.043021,-0.023421,0.033723,0.037839,-0.103213,0.017492,-0.031629,0.059406,-0.026698,0.022034,0.004997,-0.066013,-0.025418,-0.102323,-0.007298,-0.047351,0.031364,-0.084918,-0.065701]'
LIMIT 100;

EXPLAIN ANALYZE
SELECT frame_number, frame_time, ip_src, ip_dst, tcp_srcport, tcp_dstport, protocol, frame_len, embedding
FROM network_traffic_hnsw
ORDER BY embedding <=> '[0.001047,0.05761,-0.049761,0.006044,-0.082155,-0.068032,0.031118,0.001534,-0.003469,-0.022295,-0.037904,-0.062905,0.020716,-5e-05,0.035432,-0.028556,-0.039935,-0.087186,-0.004333,-0.028506,-0.023882,0.039156,-0.040344,-0.030104,0.002576,0.026598,-0.025732,0.055856,0.019161,-0.036489,-0.089994,0.025581,-0.037664,0.009907,-0.08406,-0.07957,-0.04822,-0.04798,-0.00666,0.026506,0.035922,0.00135,0.111183,0.054961,0.019476,0.02874,-0.041432,0.149745,0.060976,-0.068772,-0.016007,0.024525,-0.027068,0.052283,0.026125,0.011397,-0.034266,-0.036035,-0.025243,-0.011355,0.036635,0.017482,-0.030254,0.080118,0.078688,-0.070037,-0.047792,0.043284,0.065689,-0.02105,-0.044606,0.012727,-0.082126,-0.009596,0.023298,0.037441,-0.023563,0.016792,0.052119,0.00629,0.015001,-0.029059,-0.011732,-0.021819,0.009072,-0.070698,0.086423,0.011135,0.031143,-0.010418,0.00076,0.059775,-0.103665,0.023707,-0.060099,0.084904,0.045173,-0.117224,-0.019724,0.041206,0.077275,0.02075,-0.03925,0.057587,-0.083859,-0.028299,0.054778,0.096486,0.071814,0.095449,-0.057417,0.018605,0.013273,-0.013304,-0.012277,0.010914,-0.051666,0.008889,-0.043728,0.008945,0.005312,0.004783,-0.062221,0.005835,-0.083235,0.005685,0.050154,0,0.047425,0.002321,0.020582,-0.021209,0.007559,0.00661,-0.019001,-0.028853,-0.061182,-0.031955,-0.063446,0.011539,-0.029089,0.033035,-0.00669,0.01457,0.034262,0.062367,0.04284,0.050965,-0.046205,0.009311,-0.0275,0.02206,0.026157,0.07922,-0.081095,-0.028799,-0.101099,0.010728,0.131829,-0.046651,-0.067109,0.000356,0.018528,-0.03219,0.055784,-0.014037,0.071682,0.046096,-0.041276,0.037476,0.014455,0.00165,-0.05075,-0.023498,0.001347,-0.012045,0.047421,0.06973,-0.090741,0.003478,-0.063364,0.015379,-0.008301,-0.006809,-0.007509,0.04953,-0.038572,0.093173,0.020081,0.042386,-0.046278,-0.071677,0.01374,0.033862,-0.053179,-0.024812,0.034274,0.058316,0.006578,0.023881,0.149914,0.045956,0.056278,0.016982,0.009524,-0.011581,-0.007151,0.038278,-0.117852,0.036805,-0.009551,-0.025841,-0.107119,-0.053273,0.012198,0.042947,0.120374,0.085906,-0.075599,0.013293,0.01664,0.00974,-0.076473,0,-0.009282,0.126683,-0.034814,0.018548,-0.019534,-0.017335,0.129658,0.031364,0.018901,0.036265,0.083719,-0.029418,0.054458,0.011618,0.018144,-0.019034,0.011953,-0.029437,-0.104044,-0.022645,-0.108522,0.012095,-0.008892,0.007199,0.012115,-0.003089,-0.002098,-0.086063,-0.099399,-0.044523,-0.010077,-0.042991,-0.040193,0.067323,-0.003182,-0.032191,0.086047,0.108777,0.026362,-0.011979,0.071559,0.040289,-0.028287,0.04831,0.059803,-0.017369,0.106129,-0.052919,-0.065957,-0.041301,0.051324,-0.050371,0.027128,0.082471,0.019871,0.043742,0.019467,0.068107,0.002847,0.009033,0.090858,-0.057667,-0.051794,0.073382,0.08674,-0.01965,-0.073387,-0.011621,0.062587,0.015102,-0.046239,0.006864,0.111094,0.011186,0.070184,-0.029243,0.017467,0.016068,-0.035176,-0.016001,-0.048663,0.07754,0.010788,-0.087545,0.015634,0.044651,0.035204,0.030295,-0.024961,-0.019756,-0.091956,0.083481,-0.07207,-0.030486,0.031459,0,-0.01435,0.018892,-0.054858,0.083456,-0.016066,0.142768,0.049076,0.015662,-0.000303,0.002781,0.023061,-0.040918,-0.00929,-0.044196,0.007489,-0.061206,-0.07306,0.039832,-0.023916,-0.094452,-0.003662,0.025215,-0.043658,0.036914,-0.021507,0.001247,0.036317,0.034739,-0.065639,0.011099,-0.056292,-0.051628,-0.007438,-0.054219,0.021565,0.086079,-0.089869,0.074005,0.037545,0.070924,-0.028373,-0.033131,0.006777,-0.03776,0.090828,-0.043021,-0.023421,0.033723,0.037839,-0.103213,0.017492,-0.031629,0.059406,-0.026698,0.022034,0.004997,-0.066013,-0.025418,-0.102323,-0.007298,-0.047351,0.031364,-0.084918,-0.065701]'
LIMIT 100;